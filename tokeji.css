/* ============================================
   TOKEJI v17.0 - CSS COMPLETO
   Extracción pura del monolito + nuevas páginas
   ============================================ */

/* === FUENTES === */
@import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;600;700;800&display=swap');

/* === VARIABLES CSS === */
:root {
  --device-color: #FF6B9D;
  --device-dark: #FF4785;
  --device-light: #FFB8D0;
  --screen-bg: #FFF5F7;
  
  /* Colores de sobres */
  --sobre-verde: #48BB78;
  --sobre-azul: #4299E1;
  --sobre-morado: #9F7AEA;
  --sobre-blanco: #E2E8F0;
}

/* === RESET Y BASE === */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  -webkit-touch-callout: none;
}

html, body {
  touch-action: pan-x pan-y;
  -webkit-text-size-adjust: 100%;
}

body {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 10px;
  font-family: 'Nunito', sans-serif;
  overflow: hidden;
  position: fixed;
  width: 100%;
  height: 100%;
}

/* === DISPOSITIVO FÍSICO (INALTERABLE) === */
.device {
  width: 340px;
  height: 600px;
  background: linear-gradient(145deg, var(--device-light) 0%, var(--device-color) 50%, var(--device-dark) 100%);
  border-radius: 40px;
  padding: 25px 15px 15px 15px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.3);
  position: relative;
  display: flex;
  flex-direction: column;
  border: 3px solid rgba(255,255,255,0.2);
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  will-change: transform;
  margin: auto;
}

/* Tornillos */
.screw {
  position: absolute;
  width: 12px;
  height: 12px;
  background: linear-gradient(145deg, #E8E8E8, #A0A0A0);
  border-radius: 50%;
  box-shadow: inset 0 1px 2px rgba(255,255,255,0.8), 0 2px 4px rgba(0,0,0,0.3);
  z-index: 10;
}

.screw::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) rotate(45deg);
  width: 6px;
  height: 2px;
  background: #666;
  box-shadow: 0 0 0 1px #666;
}

.screw-tl { top: 12px; left: 15px; }
.screw-tr { top: 12px; right: 15px; }
.screw-bl { bottom: 100px; left: 15px; }
.screw-br { bottom: 100px; right: 15px; }

/* Branding */
.device-logo {
  position: absolute;
  top: 8px;
  left: 50%;
  transform: translateX(-50%);
  font-family: 'Fredoka One', cursive;
  font-size: 11px;
  color: rgba(255,255,255,0.9);
  letter-spacing: 2px;
  text-shadow: 0 2px 4px rgba(0,0,0,0.2);
  z-index: 5;
}

.shine {
  position: absolute;
  top: 15px;
  left: 20%;
  right: 20%;
  height: 25%;
  background: linear-gradient(180deg, rgba(255,255,255,0.3) 0%, transparent 100%);
  border-radius: 50% 50% 0 0;
  pointer-events: none;
}

/* Badge de cola */
.cola-badge {
  position: absolute;
  top: 5px;
  right: 5px;
  background: #F56565;
  color: white;
  font-size: 11px;
  font-weight: 800;
  padding: 4px 10px;
  border-radius: 12px;
  box-shadow: 0 2px 0 #C53030;
  animation: pulse-badge 2s infinite;
  display: none;
  z-index: 50;
}

.cola-badge.active {
  display: block;
}

@keyframes pulse-badge {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

/* === PANTALLA INTERNA === */
.screen-container {
  width: 100%;
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-top: 8px;
  margin-bottom: 8px;
}

.screen {
  width: 100%;
  height: 380px;
  background: var(--screen-bg);
  border-radius: 22px;
  position: relative;
  overflow: hidden;
  box-shadow: inset 0 2px 10px rgba(0,0,0,0.1);
  border: 4px solid #2D3748;
  display: flex;
  flex-direction: column;
}

/* Debug */
.debug-info {
  position: absolute;
  top: 30px;
  left: 5px;
  right: 5px;
  background: rgba(0,0,0,0.8);
  color: #0f0;
  font-family: monospace;
  font-size: 9px;
  padding: 5px;
  border-radius: 5px;
  z-index: 1000;
  max-height: 100px;
  overflow-y: auto;
  display: none;
}

/* Status bar */
.status-bar {
  position: absolute;
  top: 8px;
  left: 12px;
  right: 12px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 10px;
  font-weight: 800;
  color: #718096;
  z-index: 10;
  font-family: 'Fredoka One', cursive;
}

/* Contenido principal */
.content {
  flex: 1;
  padding: 28px 12px 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  overflow: hidden;
  position: relative;
}

/* === SISTEMA DE PÁGINAS === */
.page { 
  display: none; 
  width: 100%; 
  height: 100%;
  flex-direction: column;
}

.page.active { display: flex; }

/* === PÁGINA: SPLASH === */
#page-splash {
  justify-content: center;
  align-items: center;
  text-align: center;
  background: linear-gradient(145deg, var(--device-color), var(--device-light));
  height: 100%;
  width: 100%;
  padding: 0;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: 18px;
}

.splash-logo {
  font-family: 'Fredoka One', cursive;
  font-size: 52px;
  color: white;
  text-shadow: 0 4px 0 var(--device-dark), 0 6px 10px rgba(0,0,0,0.2);
  animation: pulse-logo 2s ease-in-out infinite;
  transform: translateZ(0);
  margin-bottom: 20px;
}

@keyframes pulse-logo {
  0%, 100% { transform: scale(1) translateZ(0); opacity: 1; }
  50% { transform: scale(1.05) translateZ(0); opacity: 0.9; }
}

.splash-hint {
  position: absolute;
  bottom: 50px;
  font-size: 14px;
  color: rgba(255,255,255,0.9);
  animation: blink 1.5s infinite;
  font-weight: 700;
}

@keyframes blink {
  0%, 100% { opacity: 0.4; }
  50% { opacity: 1; }
}

/* === PÁGINA: CONSENT === */
#page-consent {
  justify-content: center;
  align-items: center;
  background: var(--screen-bg);
  height: 100%;
  width: 100%;
  padding: 20px;
}

.consent-title {
  font-family: 'Fredoka One', cursive;
  font-size: 20px;
  color: #2D3748;
  margin-bottom: 15px;
}

.consent-text {
  font-size: 12px;
  color: #4A5568;
  line-height: 1.5;
  margin-bottom: 20px;
  max-width: 260px;
}

.consent-buttons {
  display: flex;
  gap: 12px;
  width: 100%;
  max-width: 220px;
}

.consent-btn {
  flex: 1;
  padding: 12px;
  border: none;
  border-radius: 12px;
  font-family: 'Nunito', sans-serif;
  font-size: 14px;
  font-weight: 800;
  cursor: pointer;
  transition: all 0.1s ease;
  box-shadow: 0 3px 0 rgba(0,0,0,0.2);
}

.consent-btn.no {
  background: #E2E8F0;
  color: #4A5568;
  box-shadow: 0 3px 0 #CBD5E0;
}

.consent-btn.si {
  background: #48BB78;
  color: white;
  box-shadow: 0 3px 0 #38A169;
}

.consent-btn.focused {
  transform: scale(1.05);
  box-shadow: 0 0 0 3px rgba(255,107,157,0.3);
}

/* === PÁGINA: SETUP === */
#page-setup {
  justify-content: center;
  align-items: center;
  background: var(--screen-bg);
  height: 100%;
  width: 100%;
  padding: 20px;
}

.setup-title {
  font-family: 'Fredoka One', cursive;
  font-size: 20px;
  color: #2D3748;
  margin-bottom: 25px;
  text-align: center;
}

.setup-title-compact {
  font-family: 'Fredoka One', cursive;
  font-size: 16px;
  color: #2D3748;
  margin-bottom: 15px;
  text-align: center;
  padding-top: 5px;
}

.setup-input {
  width: 100%;
  max-width: 260px;
  padding: 14px;
  border: 3px solid #FFD93D;
  border-radius: 14px;
  font-size: 22px;
  text-align: center;
  text-transform: uppercase;
  font-weight: 800;
  background: white;
  outline: none;
  font-family: 'Nunito', sans-serif;
  -webkit-appearance: none;
  margin-bottom: 15px;
}

.setup-hint {
  font-size: 12px;
  color: #A0AEC0;
}

/* === PÁGINA: AVATAR === */
#page-avatar {
  justify-content: flex-start;
  align-items: center;
  background: var(--screen-bg);
  height: 100%;
  width: 100%;
  padding: 30px 20px 20px 20px;
}

.avatar-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
  width: 100%;
  max-width: 280px;
  margin-top: 10px;
}

.avatar-item {
  aspect-ratio: 1;
  background: white;
  border: 3px solid #E2E8F0;
  border-radius: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 28px;
  cursor: pointer;
  transition: all 0.1s ease;
  box-shadow: 0 3px 0 #CBD5E0;
}

.avatar-item:active {
  transform: translateY(3px);
  box-shadow: 0 0 0 #CBD5E0;
}

.avatar-item.focused {
  border-color: var(--device-color);
  background: #FFF5F7;
  transform: scale(1.1);
  box-shadow: 0 0 0 3px rgba(255,107,157,0.3);
}

/* === PÁGINA: COLOR (FIX C4 - Navegable D-Pad) === */
#page-color {
  justify-content: flex-start;
  align-items: center;
  background: var(--screen-bg);
  height: 100%;
  width: 100%;
  padding: 30px 20px 20px 20px;
}

.color-setup-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr); /* FIX C4: 3 columnas, no 2 */
  gap: 15px;
  width: 100%;
  max-width: 220px;
  max-height: 320px;
  overflow-y: auto;
  margin-top: 10px;
  padding: 10px;
  -webkit-overflow-scrolling: touch;
}

.color-setup-item {
  width: 60px; /* FIX C4: 60px, no 85px */
  height: 60px;
  border: 4px solid white;
  border-radius: 16px;
  cursor: pointer;
  transition: all 0.1s ease;
  box-shadow: 0 4px 0 rgba(0,0,0,0.2);
  flex-shrink: 0;
  position: relative;
  margin: 0 auto;
}

.color-setup-item::after {
  content: attr(data-name);
  position: absolute;
  bottom: -20px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 11px;
  font-weight: 700;
  color: #2D3748;
  white-space: nowrap;
}

.color-setup-item.focused {
  transform: scale(1.08);
  box-shadow: 0 0 0 4px rgba(255,107,157,0.5), 0 4px 0 rgba(0,0,0,0.2);
}

/* === PÁGINA: HOME === */
#page-home {
  justify-content: center;
  align-items: center;
  background: var(--screen-bg);
}

.home-main {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.home-avatar {
  font-size: 60px;
  filter: drop-shadow(0 4px 8px rgba(0,0,0,0.15));
  animation: float 3s ease-in-out infinite;
  transform: translateZ(0);
}

@keyframes float {
  0%, 100% { transform: translateY(0) translateZ(0); }
  50% { transform: translateY(-8px) translateZ(0); }
}

.home-name {
  font-family: 'Fredoka One', cursive;
  font-size: 22px;
  color: #2D3748;
}

.home-status {
  font-size: 11px;
  padding: 5px 14px;
  border-radius: 20px;
  font-weight: 800;
  color: white;
  background: #48BB78;
  box-shadow: 0 2px 0 #2F855A;
}

.tokes-badge {
  background: #ECC94B;
  color: #744210;
  padding: 6px 16px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: 800;
  margin-top: 6px;
  box-shadow: 0 2px 0 #B7791F;
}

.streak-badge {
  background: #F56565;
  color: white;
  padding: 6px 16px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: 800;
  margin-top: 6px;
  box-shadow: 0 2px 0 #C53030;
  animation: pulse-streak 2s infinite;
}

@keyframes pulse-streak {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

/* === PÁGINA: MENÚ (3x3) === */
#page-menu {
  background: var(--screen-bg);
  padding: 10px;
}

.menu-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr); /* FIX: 3 columnas */
  grid-template-rows: repeat(3, 1fr);
  gap: 8px;
  width: 100%;
  height: 100%;
  padding: 0 5px;
}

.menu-item {
  background: #ffffff;
  border: 3px solid #E2E8F0;
  border-radius: 14px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 4px;
  font-size: 10px;
  font-weight: 800;
  color: #4A5568;
  transition: all 0.1s ease;
  cursor: pointer;
  box-shadow: 0 3px 0 #CBD5E0;
  min-height: 0;
  padding: 5px;
}

.menu-item:active {
  transform: translateY(3px) scale(0.98);
  box-shadow: 0 0 0 #CBD5E0;
}

.menu-item.focused {
  border-color: var(--device-color);
  background: #FFF5F7;
  transform: scale(1.02);
  box-shadow: 0 0 0 3px rgba(255,107,157,0.3);
  z-index: 10;
}

.menu-item .icon {
  font-size: 24px;
  transition: transform 0.2s;
}

.menu-item.focused .icon {
  transform: scale(1.1);
}

/* === PÁGINA: SOBRES (NUEVA v17.0) === */
#page-sobres {
  background: var(--screen-bg);
  padding: 10px;
}

.sobres-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 5px;
  margin-bottom: 10px;
}

.streak-display {
  background: linear-gradient(145deg, #F6AD55, #ED8936);
  color: white;
  padding: 4px 12px;
  border-radius: 15px;
  font-size: 12px;
  font-weight: 800;
  box-shadow: 0 2px 0 #C05621;
}

.sobres-timer {
  text-align: center;
  font-size: 11px;
  color: #718096;
  margin-bottom: 15px;
  font-weight: 700;
}

.sobres-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
  margin-bottom: 15px;
}

.sobre-item {
  background: white;
  border: 3px solid #E2E8F0;
  border-radius: 16px;
  padding: 10px 5px;
  display: flex;
  flex-direction: column;
  align-items: center;
  cursor: pointer;
  transition: all 0.1s ease;
  box-shadow: 0 3px 0 #CBD5E0;
}

.sobre-item.focused {
  border-color: var(--device-color);
  transform: scale(1.05);
  box-shadow: 0 0 0 3px rgba(255,107,157,0.3), 0 3px 0 #CBD5E0;
}

.sobre-icon {
  font-size: 32px;
  margin-bottom: 4px;
}

.sobre-label {
  font-size: 10px;
  font-weight: 800;
  color: #2D3748;
}

.sobre-desc {
  font-size: 8px;
  color: #718096;
  text-align: center;
}

/* Colores específicos de sobres */
.sobre-item[data-tipo="verde"].focused { border-color: var(--sobre-verde); }
.sobre-item[data-tipo="azul"].focused { border-color: var(--sobre-azul); }
.sobre-item[data-tipo="morado"].focused { border-color: var(--sobre-morado); }
.sobre-item[data-tipo="blanco"].focused { border-color: #A0AEC0; }

.sobres-tokes20 {
  background: linear-gradient(145deg, #ECC94B, #D69E2E);
  border-radius: 16px;
  padding: 15px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  cursor: pointer;
  margin-bottom: 10px;
  box-shadow: 0 3px 0 #B7791F;
  transition: all 0.1s ease;
}

.sobres-tokes20.focused {
  transform: scale(1.02);
  box-shadow: 0 0 0 3px rgba(236,201,75,0.5), 0 3px 0 #B7791F;
}

.tokes20-icon {
  font-size: 24px;
}

.tokes20-text {
  font-size: 14px;
  font-weight: 800;
  color: #744210;
}

.sobres-historial {
  background: white;
  border: 2px solid #E2E8F0;
  border-radius: 12px;
  padding: 12px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
  font-size: 12px;
  color: #4A5568;
  transition: all 0.1s ease;
}

.sobres-historial.focused {
  border-color: var(--device-color);
  background: #FFF5F7;
}

.historial-count {
  font-size: 10px;
  color: #718096;
  background: #EDF2F7;
  padding: 2px 8px;
  border-radius: 10px;
}

/* === PÁGINA: SOBRE MENSAJE === */
#page-sobre-mensaje {
  background: var(--screen-bg);
  padding: 15px;
}

.sobre-mensaje-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 15px;
  padding: 10px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 2px 0 #E2E8F0;
}

.sobre-mensaje-icon {
  font-size: 32px;
}

.sobre-mensaje-tipo {
  font-family: 'Fredoka One', cursive;
  font-size: 16px;
  color: #2D3748;
}

.sobre-mensaje-texto {
  font-size: 18px;
  font-weight: 700;
  color: #2D3748;
  text-align: center;
  padding: 20px;
  background: white;
  border-radius: 16px;
  margin-bottom: 15px;
  box-shadow: 0 2px 0 #E2E8F0;
  line-height: 1.4;
}

/* === PÁGINA: INSTITUTO === */
#page-instituto {
  background: var(--screen-bg);
  padding: 10px;
}

.instituto-header {
  margin-bottom: 10px;
}

.instituto-count {
  font-size: 11px;
  color: #718096;
  text-align: center;
}

.instituto-filtros {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}

.filtro-dropdown {
  flex: 1;
  background: white;
  border: 2px solid #E2E8F0;
  border-radius: 12px;
  padding: 10px;
  font-size: 11px;
  font-weight: 700;
  color: #4A5568;
  cursor: pointer;
  text-align: center;
  transition: all 0.1s ease;
}

.filtro-dropdown.focused {
  border-color: var(--device-color);
  background: #FFF5F7;
  box-shadow: 0 0 0 3px rgba(255,107,157,0.3);
}

.instituto-lista {
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.alumno-item {
  background: white;
  border: 2px solid #E2E8F0;
  border-radius: 14px;
  padding: 12px;
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
  transition: all 0.1s ease;
}

.alumno-item.focused {
  border-color: var(--device-color);
  background: #FFF5F7;
  transform: translateX(3px);
}

.alumno-avatar {
  font-size: 28px;
}

.alumno-info {
  flex: 1;
}

.alumno-nombre {
  font-weight: 800;
  font-size: 14px;
  color: #2D3748;
}

.alumno-curso {
  font-size: 10px;
  color: #718096;
}

.alumno-ver {
  font-size: 20px;
  opacity: 0.6;
}

/* === PÁGINA: PERFIL ALUMNO === */
#page-perfil-alumno {
  background: var(--screen-bg);
  padding: 15px;
}

.perfil-alumno-header {
  display: flex;
  align-items: center;
  gap: 15px;
  margin-bottom: 15px;
  padding: 15px;
  background: white;
  border-radius: 16px;
  box-shadow: 0 2px 0 #E2E8F0;
}

.perfil-alumno-avatar {
  font-size: 50px;
}

.perfil-alumno-nombre {
  font-family: 'Fredoka One', cursive;
  font-size: 20px;
  color: #2D3748;
}

.perfil-alumno-curso {
  font-size: 12px;
  color: #718096;
}

.perfil-alumno-todox-count {
  text-align: center;
  font-size: 14px;
  font-weight: 800;
  color: var(--device-color);
  margin-bottom: 15px;
}

.perfil-alumno-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 5px;
  flex: 1;
  overflow-y: auto;
  margin-bottom: 15px;
}

.perfil-alumno-acciones {
  display: flex;
  gap: 10px;
}

.perfil-btn {
  flex: 1;
  padding: 12px;
  border: none;
  border-radius: 12px;
  font-family: 'Nunito', sans-serif;
  font-size: 12px;
  font-weight: 800;
  cursor: pointer;
  transition: all 0.1s ease;
}

#btn-enviar-secreto {
  background: #E2E8F0;
  color: #4A5568;
  box-shadow: 0 3px 0 #CBD5E0;
}

#btn-bloquear {
  background: #F56565;
  color: white;
  box-shadow: 0 3px 0 #C53030;
}

/* === PÁGINA: MURMULLO === */
#page-murmullo {
  background: var(--screen-bg);
  padding: 10px;
  overflow-y: auto;
}

.murmullo-header {
  margin-bottom: 10px;
}

.murmullo-instituto {
  font-size: 11px;
  color: #718096;
  text-align: center;
}

.murmullo-stats-principales {
  text-align: center;
  margin-bottom: 15px;
  padding: 10px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 2px 0 #E2E8F0;
}

.murmullo-stat-item .stat-num {
  font-family: 'Fredoka One', cursive;
  font-size: 28px;
  color: var(--device-color);
  display: block;
}

.murmullo-stat-item .stat-label {
  font-size: 11px;
  color: #718096;
}

.murmullo-seccion {
  margin-bottom: 15px;
  padding: 12px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 2px 0 #E2E8F0;
}

.murmullo-titulo-seccion {
  font-size: 10px;
  font-weight: 800;
  color: #718096;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 10px;
}

.murmullo-ahora, .murmullo-hoy, .murmullo-tendencias {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.ahora-item, .hoy-item, .tendencia-item {
  font-size: 12px;
  color: #2D3748;
  padding: 6px 0;
  border-bottom: 1px solid #EDF2F7;
}

.ahora-item:last-child, .hoy-item:last-child {
  border-bottom: none;
}

.murmullo-mi-posicion {
  text-align: center;
  font-size: 11px;
  color: #718096;
  font-style: italic;
  padding: 10px;
  background: linear-gradient(145deg, #FFF5F7, #FED7E2);
  border-radius: 12px;
}

/* === PÁGINA: ENCUESTA === */
#page-encuesta {
  background: linear-gradient(145deg, rgba(255,107,157,0.95), rgba(255,71,133,0.95));
  justify-content: center;
  align-items: center;
  padding: 20px;
}

.encuesta-container {
  background: white;
  border-radius: 20px;
  padding: 25px;
  width: 100%;
  max-width: 280px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
}

.encuesta-badge {
  background: #805AD5;
  color: white;
  font-size: 10px;
  font-weight: 800;
  padding: 4px 12px;
  border-radius: 20px;
  display: inline-block;
  margin-bottom: 15px;
}

.encuesta-pregunta {
  font-family: 'Fredoka One', cursive;
  font-size: 18px;
  color: #2D3748;
  margin-bottom: 20px;
  line-height: 1.4;
}

.encuesta-filtros {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}

.encuesta-lista {
  max-height: 150px;
  overflow-y: auto;
  margin-bottom: 15px;
}

.encuesta-opcion {
  background: #EDF2F7;
  border: 2px solid transparent;
  border-radius: 12px;
  padding: 10px;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
  transition: all 0.1s ease;
}

.encuesta-opcion.focused {
  border-color: var(--device-color);
  background: #FFF5F7;
  transform: scale(1.02);
}

.encuesta-opcion-avatar {
  font-size: 24px;
}

.encuesta-opcion-nombre {
  font-weight: 700;
  font-size: 14px;
  color: #2D3748;
}

.encuesta-footer {
  text-align: center;
  font-size: 10px;
  color: #718096;
}

/* === PÁGINA: MATCH MUTUO === */
#page-match-mutuo {
  background: linear-gradient(145deg, rgba(255,107,157,0.95), rgba(255,71,133,0.95));
  justify-content: center;
  align-items: center;
  padding: 20px;
}

.match-container {
  background: white;
  border-radius: 20px;
  padding: 30px;
  width: 100%;
  max-width: 280px;
  text-align: center;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  animation: popIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes popIn {
  0% { transform: scale(0) rotate(-10deg); }
  70% { transform: scale(1.1) rotate(5deg); }
  100% { transform: scale(1) rotate(0deg); }
}

.match-icon {
  font-size: 50px;
  margin-bottom: 10px;
}

.match-titulo {
  font-family: 'Fredoka One', cursive;
  font-size: 24px;
  color: #2D3748;
  margin-bottom: 10px;
}

.match-descripcion {
  font-size: 13px;
  color: #4A5568;
  margin-bottom: 20px;
  line-height: 1.4;
}

.match-pregunta {
  font-size: 14px;
  font-weight: 700;
  color: #2D3748;
  margin-bottom: 20px;
}

.match-botones {
  display: flex;
  gap: 15px;
  margin-bottom: 15px;
}

.match-btn {
  flex: 1;
  padding: 12px;
  border: none;
  border-radius: 20px;
  font-family: 'Nunito', sans-serif;
  font-size: 13px;
  font-weight: 800;
  cursor: pointer;
  transition: all 0.1s ease;
}

.match-btn.no {
  background: #E2E8F0;
  color: #4A5568;
  box-shadow: 0 3px 0 #CBD5E0;
}

.match-btn.si {
  background: #48BB78;
  color: white;
  box-shadow: 0 3px 0 #38A169;
}

.match-btn.focused {
  transform: scale(1.05);
}

.match-nota {
  font-size: 10px;
  color: #718096;
  font-style: italic;
}

/* === PÁGINAS EXISTENTES (Toques, Contactos, etc) === */
#page-tokes, #page-variantes, #page-enviar, #page-contacts, #page-todox, #page-combates, #page-settings {
  background: var(--screen-bg);
  padding: 10px;
}

/* Listas genéricas */
.list-container {
  width: 100%;
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 0 5px 5px 5px;
  -webkit-overflow-scrolling: touch;
}

.list-item, .toke-item, .variante-item {
  background: white;
  border: 2px solid #E2E8F0;
  border-radius: 14px;
  padding: 12px;
  font-size: 13px;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 10px;
  transition: all 0.1s ease;
  box-shadow: 0 2px 0 #E2E8F0;
  flex-shrink: 0;
  min-height: 54px;
  cursor: pointer;
}

.list-item.focused, .toke-item.focused, .variante-item.focused {
  border-color: var(--device-color);
  background: #FFF5F7;
  transform: translateX(3px);
  box-shadow: 0 2px 0 #F687B3;
}

/* Toke items por categoría */
.toke-item.t1 { border-color: #FF0066; background: #FFF0F3; }
.toke-item.t1.focused { box-shadow: 0 2px 0 #CC0052; }
.toke-item.t2 { border-color: #FF5400; background: #FFF4F0; }
.toke-item.t2.focused { box-shadow: 0 2px 0 #CC4400; }
.toke-item.t3 { border-color: #38A169; background: #F0FFF4; }
.toke-item.t3.focused { box-shadow: 0 2px 0 #276749; }
.toke-item.t4 { border-color: #D69E2E; background: #FFFBEB; }
.toke-item.t4.focused { box-shadow: 0 2px 0 #B7791F; }
.toke-item.t5 { border-color: #3182CE; background: #EBF8FF; }
.toke-item.t5.focused { box-shadow: 0 2px 0 #2C5282; }

.variante-item { border-left: 4px solid; }
.variante-item.v1 { border-left-color: #FF0066; }
.variante-item.v2 { border-left-color: #FF5400; }
.variante-item.v3 { border-left-color: #38A169; }
.variante-item.v4 { border-left-color: #D69E2E; }
.variante-item.v5 { border-left-color: #3182CE; }

/* Botón scan */
.scan-btn {
  background: #805AD5;
  color: white;
  border: none;
  border-radius: 14px;
  padding: 14px;
  font-size: 13px;
  font-weight: 800;
  margin-bottom: 10px;
  box-shadow: 0 3px 0 #6B46C1;
  transition: all 0.1s ease;
  flex-shrink: 0;
  width: 100%;
  cursor: pointer;
  -webkit-appearance: none;
}

.scan-btn:active {
  transform: translateY(3px);
  box-shadow: 0 0 0 #6B46C1;
}

.scan-btn.focused {
  transform: scale(1.01);
  box-shadow: 0 0 0 3px rgba(159,122,234,0.3), 0 3px 0 #6B46C1;
}

/* QR */
.qr-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

#qr-mio {
  background: white;
  padding: 16px;
  border-radius: 16px;
  box-shadow: 0 5px 20px rgba(0,0,0,0.1);
  border: 3px solid #FFD93D;
}

#qr-mio img {
  width: 140px;
  height: 140px;
  display: block;
}

.qr-hint {
  font-size: 11px;
  color: #718096;
  margin-top: 10px;
  text-align: center;
}

/* ToDox grid */
.todex-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 5px;
  width: 100%;
  flex: 1;
  overflow-y: auto;
  padding: 0 5px 5px 5px;
}

.emoji-card {
  aspect-ratio: 1;
  background: #EDF2F7;
  border: 2px solid transparent;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  transition: all 0.1s ease;
  cursor: pointer;
}

.emoji-card.captured {
  background: #48BB78;
  border-color: #276749;
  color: white;
}

.emoji-card.focused {
  border-color: var(--device-color);
  transform: scale(1.1);
  box-shadow: 0 0 8px rgba(255,107,157,0.4);
  z-index: 10;
}

.emoji-card.new-unlock {
  animation: unlockPulse 1s ease-in-out;
  background: #FFD93D !important;
  border-color: #B7791F !important;
}

@keyframes unlockPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.3); }
}

.todex-counter {
  color: var(--device-color);
  font-size: 14px;
}

/* Combates */
.combate-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 12px;
  justify-content: center;
  width: 100%;
  padding: 12px;
}

.combate-card {
  background: #805AD5;
  border: 3px solid transparent;
  border-radius: 16px;
  padding: 20px;
  color: white;
  text-align: center;
  font-weight: 800;
  box-shadow: 0 3px 0 #6B46C1;
  transition: all 0.1s ease;
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  max-height: 120px;
  cursor: pointer;
}

.combate-card:active {
  transform: translateY(3px);
  box-shadow: 0 0 0 #6B46C1;
}

.combate-card.focused {
  border-color: #FFD93D;
  transform: scale(1.02);
  box-shadow: 0 0 0 3px rgba(255,217,61,0.3), 0 3px 0 #6B46C1;
}

.combate-icon {
  font-size: 32px;
  margin-bottom: 6px;
}

.combate-titulo {
  font-size: 16px;
}

.combate-sub {
  font-size: 11px;
  opacity: 0.9;
  margin-top: 3px;
}

/* Settings */
.settings-list {
  width: 100%;
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 0 5px 5px 5px;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

.setting-item {
  background: white;
  border: 2px solid #E2E8F0;
  border-radius: 14px;
  padding: 12px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-size: 13px;
  font-weight: 700;
  transition: all 0.1s ease;
  box-shadow: 0 2px 0 #E2E8F0;
  flex-shrink: 0;
  min-height: 50px;
  cursor: pointer;
}

.setting-item.focused {
  border-color: var(--device-color);
  background: #FFF5F7;
  transform: scale(1.01);
}

.setting-item.setting-danger {
  color: #E53E3E;
}

.toggle-switch {
  width: 44px;
  height: 24px;
  background: #CBD5E0;
  border-radius: 12px;
  position: relative;
  transition: all 0.3s;
}

.toggle-switch.active {
  background: #48BB78;
}

.toggle-switch::after {
  content: '';
  position: absolute;
  width: 20px;
  height: 20px;
  background: white;
  border-radius: 50%;
  top: 2px;
  left: 2px;
  transition: all 0.3s;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.toggle-switch.active::after {
  left: 22px;
}

.color-preview {
  width: 24px;
  height: 24px;
  background: #FF6B9D;
  border-radius: 50%;
  border: 2px solid white;
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.status-text {
  font-size: 11px;
  color: #48BB78;
  font-weight: 800;
}

/* Tienda placeholder */
.tienda-placeholder {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
}

.tienda-icon {
  font-size: 60px;
  margin-bottom: 15px;
  opacity: 0.5;
}

.tienda-texto {
  font-family: 'Fredoka One', cursive;
  font-size: 20px;
  color: #2D3748;
  margin-bottom: 10px;
}

.tienda-hint {
  font-size: 12px;
  color: #718096;
}

/* === SELECTORES MODALES (FIX C1 - Dentro de .screen) === */
.selector-modal {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--screen-bg);
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  padding: 30px 20px 20px 20px;
  z-index: 100; /* FIX C1: Dentro de screen, no 1000 */
  overflow-y: auto;
}

.selector-modal.active {
  display: flex;
}

.selector-title {
  color: #2D3748;
  font-family: 'Fredoka One', cursive;
  font-size: 18px;
  margin-bottom: 20px;
  text-align: center;
  flex-shrink: 0;
}

.selector-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  width: 100%;
  max-width: 220px;
  max-height: 320px;
  overflow-y: auto;
  padding: 10px;
  -webkit-overflow-scrolling: touch;
}

.selector-item {
  width: 85px;
  height: 85px;
  border: 4px solid white;
  border-radius: 16px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 700;
  transition: all 0.1s ease;
  cursor: pointer;
  color: white;
  padding: 10px;
  flex-shrink: 0;
  box-shadow: 0 4px 0 rgba(0,0,0,0.2);
  position: relative;
  margin: 0 auto;
}

.selector-item::after {
  content: attr(data-name);
  position: absolute;
  bottom: -20px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 11px;
  font-weight: 700;
  color: #2D3748;
  white-space: nowrap;
}

.selector-item.focused {
  transform: scale(1.08);
  box-shadow: 0 0 0 4px rgba(255,107,157,0.5), 0 4px 0 rgba(0,0,0,0.2);
}

.selector-hint {
  margin-top: 15px;
  font-size: 11px;
  color: #718096;
  text-align: center;
}

.selector-emoji-grid {
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
  max-height: 280px;
}

/* === MODALES DE RESPUESTA === */
.response-modal {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(145deg, rgba(255,107,157,0.95), rgba(255,71,133,0.95));
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 20px;
  z-index: 150;
}

.response-modal.active {
  display: flex;
}

.response-title {
  color: white;
  font-family: 'Fredoka One', cursive;
  font-size: 18px;
  margin-bottom: 25px;
  text-align: center;
}

.response-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
  width: 100%;
  max-width: 200px;
}

.response-btn {
  background: rgba(255,255,255,0.95);
  border: 3px solid transparent;
  border-radius: 16px;
  padding: 15px;
  font-size: 32px;
  display: flex;
  flex-direction: column;
  align-items: center;
  transition: all 0.1s ease;
  box-shadow: 0 3px 0 rgba(0,0,0,0.1);
  cursor: pointer;
}

.response-btn.focused {
  border-color: #FFD93D;
  transform: scale(1.08);
  box-shadow: 0 0 0 4px rgba(255,217,61,0.4), 0 3px 0 rgba(0,0,0,0.1);
}

.response-btn .label {
  font-size: 10px;
  font-weight: 800;
  color: #2D3748;
  margin-top: 5px;
}

.response-actions {
  display: flex;
  gap: 15px;
  margin-top: 25px;
}

.response-action {
  padding: 12px 24px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 800;
  border: 2px solid rgba(255,255,255,0.3);
  color: white;
  background: rgba(255,255,255,0.2);
  cursor: pointer;
  transition: all 0.1s ease;
}

.response-action.focused {
  background: white;
  color: #FF6B9D;
  border-color: white;
}

/* Animación de envío */
.envio-animacion {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 150;
  animation: fadeIn 0.3s ease;
}

.envio-animacion.active {
  display: flex;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.envio-avatar-container {
  position: relative;
  width: 120px;
  height: 120px;
  margin-bottom: 20px;
}

.envio-avatar {
  position: absolute;
  font-size: 80px;
  animation: enviarAnim 1.5s ease-in-out;
  filter: drop-shadow(0 10px 20px rgba(0,0,0,0.3));
  top: 0;
  left: 0;
}

.envio-emoji-toke {
  position: absolute;
  font-size: 50px;
  bottom: -10px;
  right: -10px;
  animation: enviarAnim 1.5s ease-in-out 0.2s both;
  filter: drop-shadow(0 5px 10px rgba(0,0,0,0.3));
}

@keyframes enviarAnim {
  0% { transform: scale(0.5) rotate(-20deg); opacity: 0; }
  30% { transform: scale(1.2) rotate(10deg); opacity: 1; }
  50% { transform: scale(1) rotate(0deg); }
  70% { transform: scale(1.1) translateY(-20px); }
  100% { transform: scale(0) translateY(-100px); opacity: 0; }
}

.envio-texto {
  color: white;
  font-family: 'Fredoka One', cursive;
  font-size: 24px;
  margin-top: 20px;
  text-shadow: 0 4px 8px rgba(0,0,0,0.3);
  animation: textoPop 0.5s ease 0.3s both;
}

@keyframes textoPop {
  from { transform: scale(0); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

.envio-destino {
  color: rgba(255,255,255,0.9);
  font-size: 16px;
  margin-top: 10px;
  font-weight: 700;
}

.envio-check {
  font-size: 60px;
  color: #48BB78;
  margin-top: 20px;
  animation: checkPop 0.5s ease 1s both;
  text-shadow: 0 4px 8px rgba(0,0,0,0.3);
  display: none;
}

@keyframes checkPop {
  0% { transform: scale(0) rotate(-180deg); }
  50% { transform: scale(1.3) rotate(10deg); }
  100% { transform: scale(1) rotate(0deg); }
}

/* Toque recibido modal */
.toque-recibido-modal {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  padding: 20px 15px 15px 15px;
  z-index: 150;
  text-align: center;
  color: white;
  animation: slideUp 0.5s ease;
}

@keyframes slideUp {
  from { transform: translateY(100%); }
  to { transform: translateY(0); }
}

.toque-recibido-modal.active {
  display: flex;
}

.toque-recibido-header {
  margin-bottom: 15px;
}

.toque-recibido-avatar {
  font-size: 50px;
  margin-bottom: 5px;
  animation: bounceIn 0.8s ease;
  filter: drop-shadow(0 5px 10px rgba(0,0,0,0.2));
}

.toque-recibido-nombre {
  font-family: 'Fredoka One', cursive;
  font-size: 24px;
  text-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.toque-recibido-emoji {
  font-size: 80px;
  margin: 10px 0;
  animation: bounceIn 0.8s ease 0.2s both;
  filter: drop-shadow(0 10px 20px rgba(0,0,0,0.3));
}

@keyframes bounceIn {
  0% { transform: scale(0) rotate(-180deg); }
  50% { transform: scale(1.3) rotate(10deg); }
  70% { transform: scale(0.9) rotate(-5deg); }
  100% { transform: scale(1) rotate(0deg); }
}

.toque-recibido-mensaje {
  font-size: 14px;
  margin-bottom: 20px;
  padding: 0 10px;
  font-weight: 600;
  line-height: 1.4;
  animation: fadeInUp 0.5s ease 0.4s both;
}

@keyframes fadeInUp {
  from { transform: translateY(20px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

.respuestas-container {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  width: 100%;
  max-width: 260px;
  margin-top: auto;
  margin-bottom: 10px;
}

.respuesta-option {
  background: rgba(255,255,255,0.95);
  border: 3px solid transparent;
  border-radius: 12px;
  padding: 12px 8px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 4px 0 rgba(0,0,0,0.1);
  animation: fadeInUp 0.5s ease both;
}

.respuesta-option:nth-child(1) { animation-delay: 0.5s; }
.respuesta-option:nth-child(2) { animation-delay: 0.6s; }
.respuesta-option:nth-child(3) { animation-delay: 0.7s; }
.respuesta-option:nth-child(4) { animation-delay: 0.8s; }

.respuesta-option.focused {
  border-color: #FFD93D;
  transform: scale(1.05) translateY(-3px);
  box-shadow: 0 6px 0 rgba(0,0,0,0.2), 0 0 15px rgba(255,217,61,0.5);
}

.respuesta-option .emoji-resp {
  font-size: 28px;
  transition: transform 0.2s;
}

.respuesta-option.focused .emoji-resp {
  transform: scale(1.2);
}

.respuesta-option .texto-resp {
  font-size: 11px;
  font-weight: 800;
  color: #2D3748;
}

/* Respuesta recibida modal */
.respuesta-recibida-modal {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(145deg, #4299E1, #2B6CB0);
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 20px;
  z-index: 150;
  text-align: center;
  color: white;
  animation: fadeIn 0.3s ease;
}

.respuesta-recibida-modal.active {
  display: flex;
}

.respuesta-recibida-avatar {
  font-size: 60px;
  margin-bottom: 10px;
  animation: bounceIn 0.6s ease;
  filter: drop-shadow(0 5px 10px rgba(0,0,0,0.2));
}

.respuesta-recibida-nombre {
  font-family: 'Fredoka One', cursive;
  font-size: 22px;
  margin-bottom: 5px;
}

.respuesta-recibida-texto {
  font-size: 14px;
  opacity: 0.9;
  margin-bottom: 15px;
}

.respuesta-recibida-emoji {
  font-size: 50px;
  margin: 10px 0;
  animation: bounceIn 0.6s ease 0.2s both;
  filter: drop-shadow(0 5px 15px rgba(0,0,0,0.3));
}

.respuesta-recibida-btn {
  background: white;
  color: #4299E1;
  border: none;
  padding: 12px 40px;
  border-radius: 25px;
  font-size: 16px;
  font-weight: 800;
  cursor: pointer;
  box-shadow: 0 4px 0 rgba(0,0,0,0.2);
  margin-top: 20px;
  transition: all 0.2s ease;
}

.respuesta-recibida-btn:active {
  transform: translateY(4px);
  box-shadow: 0 0 0 rgba(0,0,0,0.2);
}

/* Notificación nuevo emoji */
.nuevo-emoji-notificacion {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: linear-gradient(145deg, #FFD93D, #F6AD55);
  border-radius: 20px;
  padding: 20px;
  text-align: center;
  box-shadow: 0 20px 60px rgba(0,0,0,0.4);
  z-index: 300;
  display: none;
  animation: popInNotif 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  border: 4px solid white;
  width: 90%;
  max-width: 280px;
  max-height: 320px;
}

@keyframes popInNotif {
  0% { transform: translate(-50%, -50%) scale(0) rotate(-10deg); }
  70% { transform: translate(-50%, -50%) scale(1.1) rotate(5deg); }
  100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); }
}

.nuevo-emoji-notificacion.active {
  display: block;
}

.nuevo-emoji-titulo {
  font-family: 'Fredoka One', cursive;
  font-size: 16px;
  color: #744210;
  margin-bottom: 10px;
}

.nuevo-emoji-display {
  font-size: 60px;
  margin: 5px 0;
  animation: floatEmoji 2s ease-in-out infinite;
  filter: drop-shadow(0 5px 15px rgba(0,0,0,0.2));
}

@keyframes floatEmoji {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

.nuevo-emoji-numero {
  font-size: 18px;
  font-weight: 800;
  color: #744210;
  margin-bottom: 3px;
}

.nuevo-emoji-rareza {
  font-size: 12px;
  font-weight: 700;
  color: #975A16;
  margin-bottom: 8px;
  padding: 2px 10px;
  background: rgba(255,255,255,0.5);
  border-radius: 10px;
  display: inline-block;
}

.nuevo-emoji-stats {
  font-size: 11px;
  color: #975A16;
  margin-bottom: 12px;
  font-weight: 600;
  display: flex;
  justify-content: center;
  gap: 8px;
}

.nuevo-emoji-btn {
  background: white;
  color: #D69E2E;
  border: none;
  padding: 10px 30px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: 800;
  cursor: pointer;
  box-shadow: 0 4px 0 rgba(0,0,0,0.1);
  transition: all 0.2s ease;
}

.nuevo-emoji-btn:active {
  transform: translateY(4px);
  box-shadow: 0 0 0 rgba(0,0,0,0.1);
}

/* Ficha ToDox */
.ficha-todex-modal {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.85);
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 20px;
  z-index: 250;
}

.ficha-todex-modal.active {
  display: flex;
}

.ficha-todex-content {
  background: white;
  border-radius: 20px;
  padding: 25px;
  width: 100%;
  max-width: 260px;
  text-align: center;
  box-shadow: 0 15px 50px rgba(0,0,0,0.4);
  border: 4px solid;
  animation: popIn 0.4s ease;
}

.ficha-todex-content.comun { border-color: #A0AEC0; background: linear-gradient(145deg, #F7FAFC, #EDF2F7); }
.ficha-todex-content.raro { border-color: #4299E1; background: linear-gradient(145deg, #EBF8FF, #BEE3F8); }
.ficha-todex-content.epico { border-color: #9F7AEA; background: linear-gradient(145deg, #FAF5FF, #E9D8FD); }
.ficha-todex-content.mitico { border-color: #ED64A6; background: linear-gradient(145deg, #FFF5F7, #FED7E2); }
.ficha-todex-content.legendario { border-color: #ECC94B; background: linear-gradient(145deg, #FFFBEB, #FEFCBF); }

.ficha-todex-emoji {
  font-size: 70px;
  margin-bottom: 10px;
  filter: drop-shadow(0 5px 10px rgba(0,0,0,0.2));
}

.ficha-todex-numero {
  font-family: 'Fredoka One', cursive;
  font-size: 20px;
  color: #2D3748;
  margin-bottom: 5px;
}

.ficha-todex-rareza {
  font-size: 12px;
  font-weight: 800;
  padding: 4px 12px;
  border-radius: 12px;
  margin-bottom: 15px;
  display: inline-block;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.ficha-todex-content.comun .ficha-todex-rareza { background: #A0AEC0; color: white; }
.ficha-todex-content.raro .ficha-todex-rareza { background: #4299E1; color: white; }
.ficha-todex-content.epico .ficha-todex-rareza { background: #9F7AEA; color: white; }
.ficha-todex-content.mitico .ficha-todex-rareza { background: #ED64A6; color: white; }
.ficha-todex-content.legendario .ficha-todex-rareza { background: #ECC94B; color: #744210; }

.ficha-todex-stats {
  display: flex;
  justify-content: space-around;
  margin-bottom: 20px;
  gap: 10px;
}

.ficha-stat {
  flex: 1;
  background: rgba(255,255,255,0.6);
  border-radius: 12px;
  padding: 10px 5px;
}

.ficha-stat-label {
  font-size: 10px;
  color: #718096;
  margin-bottom: 3px;
  font-weight: 700;
}

.ficha-stat-valor {
  font-size: 16px;
  font-weight: 800;
  color: #2D3748;
}

.ficha-todex-btn {
  background: #48BB78;
  color: white;
  border: none;
  padding: 12px 30px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: 800;
  cursor: pointer;
  box-shadow: 0 4px 0 #38A169;
  transition: all 0.2s ease;
  width: 100%;
}

.ficha-todex-btn:active {
  transform: translateY(4px);
  box-shadow: 0 0 0 #38A169;
}

/* Confirmación reinicio */
.confirm-modal {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.85);
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 25px;
  z-index: 200;
}

.confirm-modal.active {
  display: flex;
}

.confirm-box {
  background: white;
  border-radius: 20px;
  padding: 25px;
  width: 100%;
  max-width: 260px;
  text-align: center;
  box-shadow: 0 10px 40px rgba(0,0,0,0.3);
}

.confirm-title {
  font-family: 'Fredoka One', cursive;
  font-size: 20px;
  color: #E53E3E;
  margin-bottom: 12px;
}

.confirm-text {
  font-size: 13px;
  color: #4A5568;
  margin-bottom: 20px;
  line-height: 1.5;
}

.confirm-buttons {
  display: flex;
  gap: 10px;
}

.confirm-btn {
  flex: 1;
  padding: 12px;
  border: none;
  border-radius: 12px;
  font-family: 'Nunito', sans-serif;
  font-size: 13px;
  font-weight: 800;
  cursor: pointer;
  transition: all 0.1s ease;
  -webkit-appearance: none;
}

.confirm-btn.no {
  background: #E2E8F0;
  color: #4A5568;
  box-shadow: 0 3px 0 #CBD5E0;
}

.confirm-btn.si {
  background: #F56565;
  color: white;
  box-shadow: 0 3px 0 #C53030;
}

.confirm-btn.focused {
  transform: scale(1.03);
  box-shadow: 0 0 0 3px rgba(255,107,157,0.3);
}

/* Pantalla VS combate */
.combate-vs-screen {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(145deg, #1a202c, #2d3748);
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 400;
  color: white;
  padding: 20px;
}

.combate-vs-screen.active {
  display: flex;
}

.combate-vs-avatars {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 30px;
  margin-bottom: 30px;
}

.vs-lado {
  text-align: center;
}

.combate-vs-avatar {
  font-size: 60px;
  filter: drop-shadow(0 5px 15px rgba(0,0,0,0.5));
}

.combate-vs-vs {
  font-family: 'Fredoka One', cursive;
  font-size: 40px;
  color: #FFD93D;
  text-shadow: 0 4px 8px rgba(0,0,0,0.5);
  animation: pulse 1s infinite;
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

.vs-label {
  font-size: 12px;
  margin-top: 5px;
  opacity: 0.9;
}

.combate-vs-poder {
  font-size: 24px;
  font-weight: 800;
  margin-top: 10px;
}

.combate-vs-barra {
  width: 200px;
  height: 20px;
  background: rgba(255,255,255,0.2);
  border-radius: 10px;
  overflow: hidden;
  margin-top: 10px;
  position: relative;
}

.combate-vs-progreso {
  height: 100%;
  background: linear-gradient(90deg, #48BB78, #FFD93D);
  width: 0%;
  transition: width 2s ease;
}

.combate-resultado-final {
  font-family: 'Fredoka One', cursive;
  font-size: 32px;
  margin-top: 20px;
  text-shadow: 0 4px 8px rgba(0,0,0,0.5);
}

.combate-vs-btn {
  margin-top: 30px;
  padding: 12px 40px;
  background: white;
  color: #2D3748;
  border: none;
  border-radius: 25px;
  font-weight: 800;
  font-family: 'Nunito', sans-serif;
  cursor: pointer;
  box-shadow: 0 4px 0 rgba(0,0,0,0.2);
  transition: all 0.1s ease;
}

.combate-vs-btn:active {
  transform: translateY(4px);
  box-shadow: 0 0 0 rgba(0,0,0,0.2);
}

/* === CONTROLES FÍSICOS === */
.controls-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  z-index: 15;
  margin-top: -5px;
}

.dpad-circle {
  width: 110px;
  height: 110px;
  border-radius: 50%;
  background: linear-gradient(145deg, 
    rgba(255,255,255,0.4) 0%, 
    rgba(255,255,255,0.1) 50%,
    rgba(0,0,0,0.1) 100%);
  box-shadow: 
    0 4px 12px rgba(0,0,0,0.2),
    inset 0 1px 3px rgba(255,255,255,0.5),
    inset 0 -2px 4px rgba(0,0,0,0.1);
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;
}

.nav-ring {
  width: 92px;
  height: 92px;
  border-radius: 50%;
  background: linear-gradient(145deg, 
    var(--device-light) 0%, 
    var(--device-color) 60%, 
    var(--device-dark) 100%);
  box-shadow: 
    inset 0 2px 5px rgba(0,0,0,0.15),
    0 1px 3px rgba(255,255,255,0.3);
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.nav-sector {
  position: absolute;
  width: 50%;
  height: 50%;
  cursor: pointer;
  z-index: 5;
  transition: all 0.05s ease;
}

.nav-sector:active {
  background: rgba(0,0,0,0.15);
}

.sector-up {
  top: 0;
  left: 25%;
  width: 50%;
  height: 50%;
  clip-path: polygon(50% 100%, 0 0, 100% 0);
}

.sector-down {
  bottom: 0;
  left: 25%;
  width: 50%;
  height: 50%;
  clip-path: polygon(50% 0, 0 100%, 100% 100%);
}

.sector-left {
  left: 0;
  top: 25%;
  width: 50%;
  height: 50%;
  clip-path: polygon(100% 50%, 0 0, 0 100%);
}

.sector-right {
  right: 0;
  top: 25%;
  width: 50%;
  height: 50%;
  clip-path: polygon(0 50%, 100% 0, 100% 100%);
}

.nav-arrow {
  position: absolute;
  width: 0;
  height: 0;
  pointer-events: none;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,0.3));
  z-index: 6;
}

.arrow-up {
  top: 8px;
  left: 50%;
  transform: translateX(-50%);
  border-left: 10px solid transparent;
  border-right: 10px solid transparent;
  border-bottom: 14px solid rgba(255,255,255,0.95);
}

.arrow-down {
  bottom: 8px;
  left: 50%;
  transform: translateX(-50%);
  border-left: 10px solid transparent;
  border-right: 10px solid transparent;
  border-top: 14px solid rgba(255,255,255,0.95);
}

.arrow-left {
  left: 8px;
  top: 50%;
  transform: translateY(-50%);
  border-top: 10px solid transparent;
  border-bottom: 10px solid transparent;
  border-right: 14px solid rgba(255,255,255,0.95);
}

.arrow-right {
  right: 8px;
  top: 50%;
  transform: translateY(-50%);
  border-top: 10px solid transparent;
  border-bottom: 10px solid transparent;
  border-left: 14px solid rgba(255,255,255,0.95);
}

.ok-btn {
  width: 36px;
  height: 36px;
  background: radial-gradient(circle at 30% 30%, var(--device-light) 0%, var(--device-color) 60%, var(--device-dark) 100%);
  border-radius: 50%;
  border: 2px solid rgba(255,255,255,0.4);
  box-shadow: 
    0 3px 8px rgba(0,0,0,0.25),
    inset 0 -2px 4px rgba(0,0,0,0.2),
    inset 0 2px 4px rgba(255,255,255,0.3);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: 'Fredoka One', cursive;
  font-size: 10px;
  color: white;
  text-shadow: 0 1px 2px rgba(0,0,0,0.3);
  z-index: 10;
  transition: all 0.05s ease;
  position: relative;
}

.ok-btn:active {
  transform: scale(0.9);
  box-shadow: 
    0 1px 4px rgba(0,0,0,0.25),
    inset 0 2px 4px rgba(0,0,0,0.3);
}

.back-c {
  width: 85px;
  height: 42px;
  background: linear-gradient(145deg, 
    var(--device-color) 0%, 
    var(--device-dark) 100%);
  border-radius: 0 0 38px 38px;
  border: none;
  margin-top: -22px;
  padding-top: 22px;
  position: relative;
  z-index: 5;
  cursor: pointer;
  box-shadow: 
    0 4px 8px rgba(0,0,0,0.2),
    inset 0 -2px 4px rgba(0,0,0,0.2),
    inset 0 1px 2px rgba(255,255,255,0.3);
  display: flex;
  align-items: flex-end;
  justify-content: center;
  padding-bottom: 7px;
  font-family: 'Nunito', sans-serif;
  font-size: 11px;
  font-weight: 800;
  color: white;
  text-shadow: 0 1px 2px rgba(0,0,0,0.3);
  letter-spacing: 1px;
  transition: all 0.05s ease;
}

.back-c:active {
  transform: translateY(2px);
  box-shadow: 
    0 2px 4px rgba(0,0,0,0.2),
    inset 0 1px 3px rgba(0,0,0,0.25);
}

/* === UTILIDADES === */
.msg-bar {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: var(--device-color);
  color: white;
  padding: 10px;
  font-size: 12px;
  font-weight: 800;
  text-align: center;
  transform: translateY(100%);
  transition: transform 0.3s ease;
  font-family: 'Nunito', sans-serif;
  z-index: 20;
}

.msg-bar.show {
  transform: translateY(0);
}

/* Scrollbars */
::-webkit-scrollbar { width: 3px; }
::-webkit-scrollbar-thumb { background: #F687B3; border-radius: 2px; }
::-webkit-scrollbar-track { background: transparent; }

/* Info de envío */
.envio-info {
  background: #FFF5F7;
  border: 2px solid var(--device-color);
  border-radius: 12px;
  padding: 10px;
  margin-bottom: 10px;
  font-size: 11px;
  text-align: center;
  color: #2D3748;
  font-weight: 700;
}

.envio-info strong {
  color: var(--device-color);
  font-size: 13px;
}

/* Botón eliminar */
.btn-eliminar {
  background: #F56565;
  color: white;
  border: none;
  border-radius: 8px;
  padding: 6px 12px;
  font-size: 11px;
  font-weight: 800;
  cursor: pointer;
  box-shadow: 0 2px 0 #C53030;
  min-width: 32px;
  min-height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  -webkit-appearance: none;
}

.btn-eliminar:active {
  transform: translateY(2px);
  box-shadow: 0 0 0 #C53030;
}
